import argparse
import os

import matplotlib.pyplot as plt
import numpy as np
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay    
    
def plot(matrix, label):    
    fig, ax = plt.subplots(figsize=(10, 10))
    overall_train_mat = matrix
    confm = np.zeros((2,2))
    confm[0,0] = overall_train_mat[0,0]
    confm[0,1] = overall_train_mat[0, 1:].sum()
    confm[1,0] = overall_train_mat[1:,0].sum()
    confm[1,1] = 1-confm.sum()
    print(confm)
    disp = ConfusionMatrixDisplay(matrix)
    disp.plot(include_values=False, xticks_rotation='vertical', ax=ax, cmap=plt.cm.plasma)
    disp.ax_.get_images()[0].set_clim(0, 1)
    ax.set_title(f'Taiji Subject 1 Overall {label} confusion matrix')
    fig.tight_layout()
    plt.savefig(os.path.join(f'sub_1_{label}_conf_mat.png'))
    
if __name__ == "__main__":
    label = 'testing'
    matrix = [[0.21517704517704517, 0.00827838827838828, 0.022417582417582422, 0.00783882783882784, 0.0325946275946276, 0.018333333333333337, 0.02330891330891331, 0.011941391941391943, 0.019633699633699635, 0.006623931623931625, 0.01733821733821734, 0.02427350427350428, 0.030372405372405376, 0.017869352869352872, 0.01621489621489622, 0.033760683760683766, 0.004957264957264958, 0.019774114774114775, 0.010512820512820514, 0.012735042735042735, 0.0412942612942613, 0.012307692307692311, 0.024865689865689867, 0.016868131868131866, 0.007863247863247864, 0.00938949938949939, 0.02197802197802198, 0.01423076923076923, 0.03392551892551893, 0.014529914529914532, 0.009621489621489622, 0.0102991452991453, 0.02383394383394383, 0.011141636141636142, 0.012710622710622711, 0.009462759462759464, 0.01696581196581197, 0.012796092796092796, 0.008534798534798535, 0.014444444444444446, 0.019786324786324788, 0.016013431013431015, 0.012295482295482297, 0.00965811965811966, 0.032722832722832725, 0.02850427350427351],
 [0, 0.6140726146918097, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.009523809523809525, 0.0029411764705882353, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.37346239931379255],
 [0.006923076923076924, 0.01230769230769231, 0.8504259785158662, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002564102564102564, 0, 0, 0, 0, 0, 0.0015384615384615387, 0, 0, 0, 0, 0.05897435897435898, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.005494505494505495, 0, 0, 0, 0, 0, 0, 0.06177182368193604, 0],
 [0.008034188034188035, 0, 0, 0.5541003441003441, 0, 0.3353601953601954, 0, 0, 0, 0, 0, 0, 0.0015384615384615387, 0, 0.004615384615384616, 0, 0.08841491841491841, 0, 0.005128205128205128, 0, 0, 0.0017094017094017096, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0010989010989010991, 0],
 [0.0023931623931623936, 0, 0, 0, 0.9685470085470085, 0, 0, 0, 0.004188034188034188, 0, 0, 0.018461538461538463, 0, 0.0008547008547008548, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0038461538461538464, 0, 0, 0.0008547008547008548, 0, 0, 0, 0, 0, 0.0008547008547008548, 0, 0, 0, 0],
 [0.004017094017094018, 0, 0, 0.18119658119658122, 0, 0.7134554334554334, 0, 0, 0, 0, 0, 0, 0.0015384615384615387, 0, 0, 0, 0.06495726495726496, 0.0008547008547008548, 0.01623931623931624, 0, 0, 0.002564102564102564, 0, 0, 0, 0.0008547008547008548, 0, 0, 0, 0.0008547008547008548, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.008461538461538461, 0.0008547008547008548, 0.004151404151404152, 0],
 [0.0134478021978022, 0, 0, 0, 0, 0, 0.9183333333333333, 0.0038461538461538464, 0, 0, 0.011881868131868133, 0, 0.0008928571428571428, 0, 0, 0.011111111111111112, 0, 0, 0.0015384615384615387, 0, 0, 0, 0, 0, 0, 0.0008547008547008548, 0, 0, 0.012461843711843713, 0, 0.025631868131868137, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.06170940170940171, 0, 0, 0, 0, 0, 0.004273504273504274, 0.32871794871794874, 0, 0.5683028083028084, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0358974358974359, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0010989010989010991, 0, 0, 0],
 [0.0008547008547008548, 0, 0, 0, 0, 0, 0, 0, 0.9976068376068375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015384615384615387, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.06615384615384616, 0, 0, 0, 0, 0.0021978021978021982, 0.0034188034188034192, 0.28031746031746035, 0, 0.5662515262515262, 0, 0, 0.006923076923076924, 0, 0, 0, 0, 0, 0, 0.06495726495726496, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0007692307692307693, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0043956043956043965, 0.004615384615384616, 0, 0],
 [0.0034188034188034192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.937063492063492, 0, 0.028547008547008552, 0, 0.012735042735042737, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.018235653235653237, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.022735042735042735, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.6034554334554335, 0.004871794871794872, 0.3689377289377289, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.05982905982905983, 0, 0, 0.004615384615384616, 0, 0, 0, 0, 0, 0, 0.11482905982905983, 0, 0.6067643467643469, 0, 0.17742368742368744, 0, 0, 0.005982905982905983, 0.0068376068376068385, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.010256410256410256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.013461538461538462, 0, 0, 0],
 [0.027606837606837607, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5715384615384616, 0.0017094017094017096, 0.3991452991452992, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.03635499003920057, 0, 0, 0.0007692307692307693, 0, 0, 0, 0, 0, 0, 0.034700854700854704, 0, 0.17960481854606705, 0, 0.7249668670782502, 0, 0.0008771929824561404, 0.0007692307692307693, 0.0035087719298245615, 0.0008771929824561404, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.01757085020242915, 0, 0, 0],
 [0.01456829310302404, 0.0017543859649122807, 0.008771929824561403, 0.0032258064516129032, 0, 0, 0.0018796662274923148, 0, 0, 0, 0, 0, 0, 0, 0, 0.8329743893873406, 0.026881720430107527, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.03660840150228945, 0.01929824561403509, 0.040189002485175075, 0, 0.0020202020202020206, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.011827956989247313, 0],
 [0.005347826086956522, 0, 0, 0.16273051373710876, 0, 0.17551031457763577, 0, 0, 0, 0, 0, 0, 0, 0, 0.0008695652173913044, 0, 0.5752725888381843, 0.0020833333333333333, 0.04100586656060456, 0.0019230769230769232, 0, 0.006481481481481481, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.008333333333333333, 0.012053202174169917, 0.008388897736723824, 0],
 [0.05670317536218687, 0, 0.004706559263521289, 0.012831012831012832, 0, 0, 0, 0, 0, 0.0011235955056179776, 0.007225418744406086, 0, 0.02586948506820696, 0, 0.0761298156651053, 0.0038508682328907053, 0, 0.7326974483421229, 0.011035673187571923, 0.0081171726741347, 0, 0, 0, 0, 0, 0, 0, 0.0011235955056179776, 0.0012658227848101266, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00425531914893617, 0.04070548712206047, 0.012359550561797753, 0],
 [0.062400000000000004, 0, 0, 0, 0, 0.0043956043956043965, 0, 0, 0, 0, 0, 0, 0.0024000000000000002, 0, 0.0104, 0, 0.008193406593406595, 0.007692307692307693, 0.8561590900327742, 0.0043859649122807015, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.034083516483516485, 0.007692307692307693, 0.0021978021978021982, 0],
 [0.04316239316239317, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.020769230769230772, 0, 0.018461538461538463, 0, 0.0074358974358974365, 0.007948717948717949, 0.032393162393162395, 0.6167521367521368, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.03153846153846154, 0.22153846153846157, 0, 0],
 [0.01147654620095565, 0, 0.006923076923076924, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0007874015748031496, 0, 0, 0, 0.002307692307692308, 0, 0.897200494168998, 0, 0.0034188034188034192, 0, 0, 0, 0.041330362550835, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.027692307692307697, 0, 0, 0, 0, 0, 0, 0, 0.00886331516252776, 0],
 [0.04055368048858888, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.006363636363636363, 0, 0, 0, 0.0036363636363636364, 0.9170797132485435, 0.00932920536635707, 0, 0.012166298357134054, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.010871102539376407, 0],
 [0.04642287892287893, 0.013333333333333334, 0.008031135531135531, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0033333333333333335, 0, 0, 0, 0, 0, 0.032407407407407406, 0.015131792250436317, 0.8349086981095266, 0, 0.02426310167689478, 0, 0.00196078431372549, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0034482758620689655, 0, 0, 0, 0, 0.000925925925925926, 0, 0, 0, 0.015833333333333335],
 [0.040403286034353995, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00521978021978022, 0, 0.9139190582879904, 0.036996336996337, 0, 0.0015384615384615387, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0019230769230769232, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0017543859649122807, 0.01164835164835165, 0.021312576312576315, 0.007692307692307693, 0.9575923783818521, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.03263736263736264, 0, 0.026153846153846156, 0, 0, 0, 0, 0.007692307692307693, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5360866910866912, 0, 0, 0.010170940170940172, 0.38725885225885226, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.03297924297924298, 0.0030769230769230774, 0, 0, 0, 0, 0, 0, 0, 0.0017094017094017096, 0, 0, 0, 0, 0.006923076923076924, 0.027521367521367524, 0, 0, 0, 0, 0.01965811965811966, 0, 0, 0, 0, 0, 0.42131868131868133, 0.29625763125763127, 0.1847008547008547, 0, 0, 0, 0, 0, 0, 0, 0.0016239316239316241, 0, 0, 0.002307692307692308, 0, 0, 0, 0, 0.0019230769230769232, 0],
 [0.03940170940170941, 0, 0.0008547008547008548, 0.0007692307692307693, 0, 0.002307692307692308, 0, 0, 0, 0, 0.008290598290598292, 0, 0, 0, 0.007692307692307693, 0.0007692307692307693, 0, 0.0016239316239316241, 0, 0, 0, 0, 0.0008547008547008548, 0, 0, 0, 0.41106837606837604, 0.22572649572649572, 0.19333333333333336, 0, 0, 0, 0, 0, 0, 0, 0.002307692307692308, 0, 0, 0.0007692307692307693, 0, 0, 0, 0, 0.004230769230769231, 0],
 [0.015814702538840472, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015789473684210527, 0, 0, 0, 0, 0.07803566165635131, 0, 0, 0, 0, 0.007387267904509285, 0, 0, 0, 0, 0, 0.1841208791208791, 0.10901850116006197, 0.5844488985505321, 0, 0, 0, 0, 0, 0, 0, 0.0030769230769230774, 0, 0, 0, 0, 0, 0, 0, 0.002307692307692308, 0],
 [0.05026709353638488, 0, 0.005511811023622047, 0, 0, 0.006299212598425197, 0, 0.023076923076923078, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.29731073021328785, 0, 0, 0.002526532009585758, 0.6150076975417713, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.041279802069275756, 0, 0, 0.0007692307692307693, 0, 0, 0.04164642375168691, 0, 0, 0, 0.01404986826039458, 0.0015384615384615387, 0.017692307692307695, 0, 0.0007692307692307693, 0.0007692307692307693, 0, 0, 0.009878542510121458, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0017094017094017096, 0, 0.863743654006812, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.006153846153846155, 0, 0, 0],
 [0.0853846153846154, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0007692307692307693, 0.0007692307692307693, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.8994139194139195, 0, 0, 0, 0.009401709401709403, 0, 0, 0, 0, 0, 0.004261294261294262, 0, 0, 0, 0],
 [0, 0.0007692307692307693, 0, 0, 0.0018681318681318683, 0, 0, 0, 0, 0, 0, 0.0015384615384615387, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.9958241758241757, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0007692307692307693, 0, 0, 0.9992307692307691, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.0010752688172043013, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.9874124494426357, 0, 0, 0, 0, 0, 0.00967741935483871, 0, 0.001834862385321101, 0, 0, 0],
 [0.008076923076923079, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015384615384615385, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.972051282051282, 0.0017094017094017096, 0, 0, 0.0019230769230769232, 0, 0.0008547008547008548, 0, 0, 0, 0],
 [0.00823529411764706, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0025000000000000005, 0, 0.006521739130434783, 0, 0, 0, 0.033228594804178474, 0, 0.036470588235294116, 0, 0, 0, 0.0027129727819017323, 0, 0.0033333333333333335, 0, 0, 0, 0, 0, 0, 0, 0.9069974775972105, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0.06715506715506717, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0029670329670329677, 0, 0, 0.011153846153846155, 0, 0.005982905982905983, 0, 0, 0, 0, 0, 0, 0.027350427350427354, 0, 0, 0, 0.8769291819291818, 0, 0.0007692307692307693, 0.007692307692307693, 0, 0, 0, 0, 0],
 [0.02450549450549451, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.07752136752136754, 0.0010989010989010991, 0.0038461538461538464, 0.0008547008547008548, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.8921733821733822, 0, 0, 0, 0, 0, 0, 0],
 [0.002307692307692308, 0.002307692307692308, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0015384615384615387, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.015384615384615385, 0.9776923076923076, 0.0007692307692307693, 0, 0, 0, 0, 0],
 [0.0042761586239847115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000925925925925926, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.009291819291819292, 0.0021978021978021982, 0, 0.9822093928615667, 0.0010989010989010991, 0, 0, 0, 0],
 [0.018185251441065396, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0007692307692307693, 0.0018691588785046728, 0.9791763589111993, 0, 0, 0, 0],
 [0.013064713064713067, 0, 0, 0.018803418803418806, 0, 0.015384615384615385, 0, 0, 0, 0, 0, 0, 0.026141636141636143, 0, 0.0025641025641025645, 0, 0.012820512820512822, 0.0008547008547008548, 0.0517948717948718, 0.07435897435897436, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.7809157509157509, 0.003296703296703297, 0, 0],
 [0.05067155067155067, 0, 0, 0, 0, 0.0034188034188034192, 0, 0, 0, 0.0021978021978021982, 0, 0, 0.04461538461538462, 0, 0, 0, 0.0019609700644183407, 0.0015384615384615387, 0.029059829059829064, 0.3509328028293545, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004615384615384616, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.02238095238095238, 0.4878388278388279, 0.0007692307692307693, 0],
 [0.027657393724127798, 0.007692307692307693, 0.05413149652280087, 0, 0, 0.009488670244484198, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.009108527131782946, 0.008527131782945736, 0, 0, 0.048842437755481236, 0.007165487023929895, 0.01117056856187291, 0, 0, 0.0026086956521739132, 0.017123745819397993, 0.015349701416435492, 0.022051282051282053, 0, 0, 0, 0, 0, 0, 0.0007751937984496124, 0.006923076923076924, 0.002325581395348837, 0.007692307692307693, 0, 0, 0, 0, 0, 0.7413663948117942, 0],
 [0, 0.187059862709469, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002307692307692308, 0.008653846153846154, 0, 0, 0, 0, 0, 0, 0.002564102564102564, 0, 0.002564102564102564, 0, 0.008974358974358975, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.7878760347264284]]
    plot(np.array(matrix), label)